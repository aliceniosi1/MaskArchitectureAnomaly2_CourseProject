trainer:
  max_epochs: 8
  logger:
    class_path: lightning.pytorch.loggers.wandb.WandbLogger
    init_args:
      resume: allow
      project: "eomt"
      name: "cityscapes_semantic_eomt_base_640"
model:
  class_path: training.mask_classification_semantic.MaskClassificationSemantic
  init_args:
    attn_mask_annealing_enabled: True
    attn_mask_annealing_start_steps: [3317, 8292, 13268]
    attn_mask_annealing_end_steps: [6634, 11609, 16585]
    # --- Step 0 (OE) ---
    train_class_head_only: true
    oe_enabled: true
    oe_lambda: 0.1
    oe_temperature: 1.0
    lr: 0.001
    weight_decay: 0.0
    network:
      class_path: models.eomt.EoMT
      init_args:
        num_q: 100
        num_blocks: 3
        encoder:
          class_path: models.vit.ViT
          init_args:
            backbone_name: vit_base_patch14_reg4_dinov2
data:
  class_path: datasets.cityscapes_semantic.CityscapesSemantic
  init_args:
    # NOTE: Set these paths in Colab (or override via CLI)
    # path: "/content/drive/MyDrive/<CITYSCAPES_ZIPS_DIR>"

    # --- Step 0 (OE) ---
    oe_enabled: true
    # Folder containing: train2017.zip and annotations_trainval2017.zip
    oe_coco_path: "/content/drive/MyDrive/<COCO_ZIPS_DIR>"
    oe_paste_prob: 0.5
    oe_min_rel_size: 0.05
    oe_max_rel_size: 0.35
    oe_max_tries: 20